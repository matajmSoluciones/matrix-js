!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Matrix=e()}(this,function(){"use strict";var o={isMultiply:function(t,e){return"number"==typeof e||t.width==e.height&&e.dimension==t.dimension},inmultiply:function(t,e){if("number"==typeof e){for(var n={width:t.width,height:t.height,dimension:t.dimension,data:new t.instance(t.length)},i=0,r=t.length;i<r;i++)n.data[i]=t.data[i]*e;return n}return o.__inmultiplyMatrix(t,e)},__inmultiplyMatrix:function(t,e){for(var n={width:e.width,height:t.height,dimension:t.dimension,data:new t.instance(e.width*t.height*t.dimension)},i=0,r=0,o=0,a=n.data.length;i<a;i+=n.dimension,r++){r>=n.width&&(r=0,o++);for(var h=0;h<t.width;h++){var s=t.get(h,o),u=e.get(r,h);if(1!=n.dimension)for(var d=0;d<n.dimension;d++)n.data[i+d]+=s[d]*u[d];else n.data[i]+=u*s}}return n},sum:function(t,e,n){return"number"==typeof e?o.__sumConstant(t,e,n):o.__sumMatrix(t,e,n)},__sumConstant:function(t,a,e){return e&&(a=-a),t.map(function(t,e,n,i){if("number"==typeof t)return t+a;for(var r=0,o=t.length;r<o;r++)t[r]+=a;return t})},__sumMatrix:function(t,h,s){return t.map(function(t,e,n,i){var r=h.get(e,n);if("number"==typeof t&&"number"==typeof r)return s&&(r=-r),t+r;for(var o=0,a=r.length;o<a;o++)s&&(r[o]=-r[o]),t[o]+=r[o];return t})}},a=o;function m(t,e,n,i,r){if(!arguments.length)throw new Error("Es requerido un argumento");if(1==arguments.length){if("object"!=typeof t)throw new Error("config debe ser un objeto.");r=t}if(2==arguments.length&&((r=e).data=t),2<arguments.length){if((r=r||{})&&"object"!=typeof r)throw new Error("config debe ser un objeto.");e&&(r.width=e),n&&(r.height=n),r.data=t}if(!r.width)throw new Error("Es necesario el ancho de la matriz.");if(!r.height)throw new Error("Es necesario el alto de la matriz.");var o={width:{value:r.width,writable:!1,enumerable:!0},height:{value:r.height,writable:!1,enumerable:!0},dimension:{value:1,writable:!1,enumerable:!0},__MAX_LIMIT_WIDTH:{value:0,writable:!1,enumerable:!0},__MAX_LIMIT_HEIGHT:{value:0,writable:!1,enumerable:!0},length:{value:0,writable:!1,enumerable:!0},size:{value:0,writable:!1,enumerable:!0}};if(r.dimension&&(o.dimension.value=r.dimension),o.__MAX_LIMIT_WIDTH.value=r.width*o.dimension.value,o.__MAX_LIMIT_HEIGHT.value=r.height*o.dimension.value,o.length.value=o.__MAX_LIMIT_WIDTH.value*r.height,o.size.value=r.width*r.height,r.type){if(r.type=r.type.toLowerCase(),!(r.type in m.typeArray))throw new Error("El tipo de objeto no es valido...");o.instance={value:m.typeArray[r.type],writable:!0,enumerable:!0}}if("number"!=typeof o.width.value)throw new Error("El ancho no es un numero");if("number"!=typeof o.height.value)throw new Error("El alto no es un numero");if("number"!=typeof o.dimension.value)throw new Error("La dimension no es un numero");Object.defineProperties(this,o),r.data?this.data=r.data:this.data=new this.instance(this.length)}function e(t,e,n){var i={type:"float32"};if(!arguments.length||3<arguments.length)throw new Error("El numero de argumentos es invalido...");return 1==arguments.length&&(i.width=i.height=t,i.dimension=1),2==arguments.length&&(i.width=t,i.height=e,i.dimension=1),3==arguments.length&&(i.width=t,i.height=e,i.dimension=n),new m(i)}return m.random=function(t,e,n){n=n||1,e=e||t;for(var i=new Float32Array(t*e*n),r=0,o=i.length;r<o;r++)i[r]=Math.random();return m.new({width:t,height:e,dimension:n,type:"float32",data:i})},m.PI=function(t,e,n){n=n||1,e=e||t;for(var i=new Float32Array(t*e*n),r=0,o=i.length;r<o;r++)i[r]=Math.PI;return m.new({width:t,height:e,dimension:n,type:"float32",data:i})},m.zeros=function(t,e,n){return m.new({width:t,height:e=e||t,dimension:n,type:"int8"})},m.ones=function(t,e,n){n=n||1,e=e||t;for(var i=new Int8Array(t*e*n),r=0,o=i.length;r<o;r++)i[r]=1;return m.new({width:t,height:e,dimension:n,type:"int8",data:i})},m.eyes=function(t,e){var n,r,i={type:"int8",data:n};if(!arguments.length||2<arguments.length)throw new Error("El numero de argumentos es invalido...");return 1==arguments.length&&(i.width=i.height=t,i.dimension=1),2==arguments.length&&(i.width=i.height=t,i.dimension=e||1),n=new Int8Array(i.width*i.height*i.dimension),(r=m.new(i)).forEach(function(t,e,n){var i;i=1==r.dimension?e==n?1:0:t.map(function(t){return e==n?1:0}),r.set(e,n,i)}),r},m.prototype.get=function(t,e){var n=this.getIndex(t,e);if(!(t<0||t>=this.width||e<0||e>=this.height))return 1==this.dimension?this.data[n]:this.data.slice(n,n+this.dimension)},m.prototype.set=function(t,e,n){var i,r,o=this.getIndex(t,e);if(1!=this.dimension){if(null==n||null==n||null==n.length)throw new Error("Debe ser un array el retorno.");if(n.length!=this.dimension)throw new Error("Es necesario un indice de "+this.dimension+" dimensiones");if(i=n.length,(r=this.length)<i||r<o+i)throw new Error("El reemplazo es incorrecto!. Repare los indices");for(var a=0;a<i;a++)this.data[o+a]=n[a]}else this.data[o]=n},m.prototype.getIndex=function(t,e){var n=(t+e*this.width)*this.dimension;return Math.round(n)},m.prototype.getField=function(t,e){return console.warn("El metodo getField será descontinuado para la proxima version."),this.get(t,e)},m.prototype.setField=function(t,e,n){return console.warn("El metodo setField será descontinuado para la proxima version."),this.set(t,e,n)},m.prototype.forEach=function(t){if(!(t instanceof Function))throw new Error("callback debe ser una funcion.");for(var e=0,n=0,i=0;e<this.size;e++,n++){n>=this.width&&(n=0,i++),t(this.get(n,i),n,i,e)}},m.prototype.map=function(o){if(!(o instanceof Function))throw new Error("callback debe ser una funcion.");var a=this.clone();return this.forEach(function(t,e,n,i){var r=o(t,e,n,i);a.set(e,n,r)}),a},m.prototype.toString=function(){var i="";return this.forEach(function(t,e,n){1==this.dimension?i+=t+" ":i+=t.toString()+" ",e==this.width-1&&(i+="\n")}),i},m.prototype.isNumber=function(){for(var t=this.data,e=0,n=t.length;e<n;e++)if(isNaN(t[e]))return!1;return!0},m.prototype.isNotNumber=function(){return!this.isNumber()},m.prototype.isEqual=function(t){if(!(t instanceof m))throw new Error("El parametro no es un objetos matrix de comparacion...");for(var e=this.data,n=0,i=e.length;n<i;n++)if(e[n]!==t.data[n])return!1;return!0},m.prototype.isNotEqual=function(t){return!this.isEqual(t)},m.prototype.isNull=function(){return this.data.every(function(t,e){return!t})},m.prototype.isNotNull=function(){return!this.isNull()},m.prototype.isOverTriangle=function(){var o=!0,a=this;return this.forEach(function(t,e,n){if(1==a.dimension)o=o&&(n<e&&0===t||e<=n&&0!==t);else for(var i=0,r=t.length;i<r;i++)o=o&&(n<e&&0===t[i]||e<=n&&0!==t[i])}),o},m.prototype.isUnderTriangle=function(){var o=!0,a=this;return a.forEach(function(t,e,n){if(1==a.dimension)o=o&&(e<n&&0===t||n<=e&&0!==t);else for(var i=0,r=t.length;i<r;i++)o=o&&(e<n&&0===t[i]||n<=e&&0!==t[i])}),o},m.prototype.isSimetry=function(){var a=!0,h=this;return this.width==this.height&&(this.forEach(function(t,e,n){var i=h.get(n,e);if(1==h.dimension)a=a&&t===i;else for(var r=0,o=t.length;r<o;r++)a=a&&t[r]===i[r]}),a)},m.prototype.isAsimetry=function(){var a=!0,h=this;return h.width==h.height&&(h.forEach(function(t,e,n){var i=h.get(n,e);if(1==h.dimension)a=a&&t===-i;else for(var r=0,o=t.length;r<o;r++)a=a&&t[r]===-i[r]}),a)},m.prototype.isNotSimetry=function(){return!this.isSimetry()},m.prototype.sqrt=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.sqrt(t):t.map(function(t){return Math.sqrt(t)})})},m.prototype.cbrt=function(){var t=self.clone();return t.map(function(t){return 1==self.dimension?Math.cbrt(t):t.map(function(t){return Math.cbrt(t)})}),t},m.prototype.log=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.log(t):t.map(function(t){return Math.log(t)})})},m.prototype.exp=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.exp(t):t.map(function(t){return Math.exp(t)})})},m.prototype.abs=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.abs(t):t.map(function(t){return Math.abs(t)})})},m.prototype.atan=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.atan(t):t.map(function(t){return Math.atan(t)})})},m.prototype.cos=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.cos(t):t.map(function(t){return Math.cos(t)})})},m.prototype.sin=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.sin(t):t.map(function(t){return Math.sin(t)})})},m.prototype.round=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.round(t):t.map(function(t){return Math.round(t)})})},m.prototype.ceil=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.ceil(t):t.map(function(t){return Math.ceil(t)})})},m.prototype.floor=function(){var e=this;return this.map(function(t){return 1==e.dimension?Math.floor(t):t.map(function(t){return Math.floor(t)})})},m.prototype.pow=function(e){if("number"!=typeof e)throw new Error("n debe ser un numero");var n=this;return this.map(function(t){return 1==n.dimension?Math.pow(t,e):t.map(function(t){return Math.pow(t,e)})})},m.new=function(t){return new m(t)},m.prototype.toObject=function(){var t="float32";for(var e in m.typeArray)if(m.typeArray[e]instanceof this.instance){t=e;break}return{width:this.width,height:this.height,dimension:this.dimension,type:t,data:this.data.slice()}},m.prototype.clone=function(){var t=this.toObject();return m.new(t)},m.prototype.max=function(){return Math.max.apply(null,this.data)},m.prototype.min=function(){return Math.min.apply(null,this.data)},m.prototype.transposed=function(){var i=this;return this.map(function(t,e,n){return i.get(n,e)})},m.prototype.sum=function(){var t=arguments,e=this;if(!t.length)throw new Error("Es necesario un objeto");for(var n=0,i=t.length;n<i;n++){var r=t[n];if(!(r instanceof m)&&"number"!=typeof r)throw new Error("Debe pasar un objeto Matrix o un escalar");if("number"!=typeof r&&(r.width!=e.width||r.height!=e.height||r.dimension!=e.dimension))throw new Error("Las matrices no son identicas en tamaño...");e=a.sum(e,r,!1)}return e},m.prototype.subtract=function(){var t=arguments,e=this.clone();if(!t.length)throw new Error("Es necesario un objeto");for(var n=0,i=t.length;n<i;n++){var r=t[n];if(!(r instanceof m)&&"number"!=typeof r)throw new Error("Debe pasar un objeto Matrix o un escalar");if("number"!=typeof r&&(r.width!=e.width||r.height!=e.height||r.dimension!=e.dimension))throw new Error("Las matrices no son identicas en tamaño...");e=a.sum(e,r,!0)}return e},m.prototype.getRow=function(t){if("number"!=typeof t||void 0===t||t>=this.height)throw new Error("No es valido el numero de fila");var e=this.getIndex(0,t),n=(this.getIndex(this.width-1,t),this.data.slice(e,e+this.__MAX_LIMIT_WIDTH));return new m({width:this.width,height:1,dimension:this.dimension,data:n})},m.prototype.getCol=function(t){if("number"!=typeof t||void 0===t||t>=this.width)throw new Error("No es valido el numero de columna");for(var e=new this.instance(this.__MAX_LIMIT_HEIGHT),n=0,i=0;n<this.height;n++,i+=this.dimension){var r=this.getIndex(t,n);if(1==this.dimension)e[i]=this.data[r];else for(var o=0;o<this.dimension;o++)e[i+o]=this.data[r+o]}return new m({width:1,height:this.height,dimension:this.dimension,data:e})},m.prototype.slice=function(t,e,n,i,r){if(r=r||!1,"number"!=typeof t||"number"!=typeof e||"number"!=typeof n||"number"!=typeof i)throw new Error("Argumentos invalidos");for(var o=t+(n-1),a=e+(i-1),h=new this.instance(n*i*this.dimension),s=new m({width:n,height:i,dimension:this.dimension,data:h}),u=0,d=e;d<=a;d++,u++)for(var f=t,l=0;f<=o;f++,l++){var p=this.get(f,d);p&&s.set(l,u,p)}return s},m.prototype.inmultiply=function(){var t=arguments,e=this;if(!t.length)throw new Error("Es necesario un objeto");for(var n=0,i=t.length;n<i;n++){var r=t[n];if(!(r instanceof m)&&"number"!=typeof r)throw new Error("Debe pasar un objeto Matrix o un escalar");if(!a.isMultiply(e,r))throw new Error("Las matrices no son multiplicables...");e=m.new(a.inmultiply(e,r))}return e.width==e.height&&1==e.width?e.data[0]:e},m.prototype.inverse=function(){var t=this.det();return this.adj().transposed().inmultiply(1/t)},m.prototype.divide=function(){var t=arguments,e=this;if(!t.length)throw new Error("Es necesario un objeto");for(var n=0,i=t.length;n<i;n++){var r=t[n];if(!(r instanceof m)&&"number"!=typeof r)throw new Error("Debe pasar un objeto Matrix o un escalar");if("number"!=typeof r)try{e=e.inmultiply(r.inverse())}catch(t){e=r.inmultiply(e.inverse())}else e=e.inmultiply(1/r)}return e},m.prototype.not=function(){return this.inmultiply(-1)},m.prototype.isSingular=function(){return this.width==this.height},m.prototype.removeRow=function(i){var t=e(this.width,this.height-1,this.dimension);return t.map(function(t,e,n){return i<=n?this.get(e,n+1):this.get(e,n)}),t},m.prototype.removeCol=function(i){var t=e(this.width-1,this.height,this.dimension);return t.map(function(t,e,n){return i<=e?this.get(e+1,n):this.get(e,n)}),t},m.prototype.remove=function(t,e){for(var n=m.new({width:this.width-1,height:this.height-1,dimension:this.dimension}),i=0;i<n.width;i++)for(var r=0;r<n.height;r++){var o=0,a=0;e<=r&&(a=1),t<=i&&(o=1);var h=this.get(i+o,r+a);n.set(i,r,h)}return n},m.prototype.adj=function(){if(!this.isSingular())throw new Error("Debe ser una matriz cuadrada");var o=m.new({width:this.width,height:this.height,dimension:1}),a=this,h=0;return this.__adj__||(a.forEach(function(t,e,n){var i=a.remove(e,n),r=Math.pow(-1,e+n+2)*i.det();o.data[h++]=r}),this.__adj__=o),this.__adj__},m.prototype.det=function(){if(this.__determinant__)return this.__determinant__;if(1==this.width)return this.__determinant__=this.data[0],this.__determinant__;if(this.width==this.height&&2==this.width)return this.__determinant__=function(i){var r=1,o=1;if(!i.isSingular())throw new Error("La matriz no es cuadrada");return i.forEach(function(t,e,n){e==n&&(1==i.dimension?r*=t:r*=sumRow(t)),e==i.width-1-n&&(1==i.dimension?o*=t:o*=sumRow(t))}),r-o}(this),this.__determinant__;for(var t=0,e=this.adj(),n=0;n<this.width;n++)t+=this.data[n]*e.data[n];return this.__determinant__=t},m.prototype.promd=function(){for(var t=0,e=0,n=this.data.length;e<n;e++)t+=this.data[e];return t},m.prototype.convolution=function(w){var g=this,y=-Math.floor(w.width/2),v=-Math.floor(w.height/2);return this.map(function(t,e,n){var i=e+y,r=n+v,o=i+(w.width-1),a=r+(w.height-1),h=0;1<g.dimension&&(h=new g.instance(screen.dimension));for(var s=0,u=r;u<=a;u++,s++)for(var d=0,f=i;f<=o;f++,d++){var l=g.get(f,u),p=w.get(d,s);if(l)if(1==g.dimension)h+=l*p;else for(var m=0,c=h.length;m<c;m++)h+=l[m]*p[m]}return h})},m.prototype.moveRow=function(t,e){for(var n=this.getRow(t),i=this.getRow(e),r=0;r<this.width;r++)this.set(r,t,i.get(r,0)),this.set(r,e,n.get(r,0));return this},m.prototype.moveCol=function(t,e){for(var n=this.getCol(t),i=this.getCol(e),r=0;r<this.height;r++)this.set(t,r,i.get(0,r)),this.set(e,r,n.get(0,r));return this},Object.defineProperty(m.prototype,"instance",{value:Float32Array,writable:!0,enumerable:!0}),Object.defineProperty(m.prototype,"__data__",{value:null,writable:!0,enumerable:!1}),Object.defineProperty(m.prototype,"data",{enumerable:!0,configurable:!0,get:function(){return this.__data__},set:function(t){if(!m.isValidArray(t))throw new Error("El parametro data no es un objeto valido...");if(t.length!=this.length)throw new Error("No coinciden el numero de elementos de la matriz...");t instanceof this.instance?this.__data__=t:this.__data__=this.instance.from(t)}}),Object.defineProperty(m,"typeArray",{value:{int8:Int8Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint8_clamped:Uint8ClampedArray,int16:Int16Array,int32:Int32Array,float32:Float32Array,float64:Float64Array,buffer:ArrayBuffer},writable:!1,enumerable:!0}),m.isValidArray=function(t){var e=!1;if(Array.isArray(t))return!0;for(var n in m.typeArray)e=e||t instanceof m.typeArray[n];return e},Object.defineProperty(m.prototype,"Filters",{value:{BLUR:m.new({width:5,height:5,dimension:1,data:[.003,.0133,.0219,.0133,.003,.0133,.0596,.0983,.0596,.0133,.0219,.0983,.1621,.0983,.0219,.0133,.0596,.0983,.0596,.0133,.003,.0133,.0219,.0133,.003]}),GAUSSIAN:m.new({width:5,height:5,dimension:1,data:[.003663003663003663,.014652014652014652,.02564102564102564,.014652014652014652,.003663003663003663,.014652014652014652,.05860805860805861,.09523809523809523,.05860805860805861,.014652014652014652,.02564102564102564,.09523809523809523,.15018315018315018,.09523809523809523,.02564102564102564,.014652014652014652,.05860805860805861,.09523809523809523,.05860805860805861,.014652014652014652,.003663003663003663,.014652014652014652,.02564102564102564,.014652014652014652,.003663003663003663]}),MEDIA:m.new({width:3,height:3,data:[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111]}),PREWITTV:m.new({width:3,height:3,data:[-1,-1,-1,0,0,0,1,1,1]}),PREWITTH:m.new({width:3,height:3,data:[-1,0,-1,-1,0,1,-1,0,1]}),SOBELV:m.new({width:3,height:3,data:[-1,-2,-1,0,0,0,1,2,1]}),SOBELH:m.new({width:3,height:3,data:[-1,0,1,-2,0,2,-1,0,1]}),LAPLACIANO:m.new({width:3,height:3,data:[0,-1,0,-1,4,-1,0,-1,0]}),LAGAUSSIANO:m.new({width:5,height:5,data:[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,16,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]}),SHARPEN:m.new({width:5,height:5,data:[0,0,0,0,0,0,0,-1,0,0,0,-1,5,-1,0,0,0,-1,0,0,0,0,0,0,0]}),EMBOSS:m.new({width:3,height:3,data:[-2,-1,0,-1,1,1,0,1,2]})},writable:!1,enumerable:!0}),m});
